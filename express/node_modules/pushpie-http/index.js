var http = require('http');

module.exports = (function(){
	function get(config){
		var config = config || {};
		var options = {
			host : config.options.host || 'localhost',
			port : config.options.port || '8080',
			path : config.options.path || '',
			method : 'GET',
			headers: config.options.headers || {}
		};
		var req = http.request(options, function(res) {
			res.setEncoding('utf8');
			res.on('data', function(chunk) {
				var json;
				//console.log(chunk);
				if(res.statusCode == 200){
					json = JSON.parse(chunk);
				}else{
					json = {"errorCode":""+(res.statusCode||500)};
				}
				(typeof(config.callback) == 'function') && config.callback(json);
			});
		});
		req.on('error', function (e) {
			json = {"errorCode":"9998", "errorMsg":e.message};
			(typeof(config.callback) == 'function') && config.callback(json);
		});

		req.end();
	}
	
	return {
		'get': get
	}
})();